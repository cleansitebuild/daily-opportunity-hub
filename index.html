<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kylan â€” Daily Opportunity Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg: #0a0a0b; --surface: #111113; --surface2: #18181b;
      --border: #27272a; --text: #fafafa; --muted: #71717a;
      --green: #22c55e; --yellow: #eab308; --blue: #3b82f6;
      --purple: #a855f7; --red: #f87171; --orange: #f59e0b;
    }
    body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 20px 16px 60px; }
    .wrap { max-width: 780px; margin: 0 auto; }

    /* Header */
    .header { margin-bottom: 28px; }
    .header h1 { font-size: 1.4rem; font-weight: 700; }
    .header-meta { display: flex; gap: 12px; align-items: center; margin-top: 6px; flex-wrap: wrap; }
    .updated-badge { font-size: 0.75rem; color: var(--muted); }
    .version-badge { font-size: 0.7rem; background: #1c1c1e; border: 1px solid var(--border); border-radius: 20px; padding: 2px 10px; color: var(--muted); }

    /* Nav tabs */
    .tabs { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 28px; border-bottom: 1px solid var(--border); padding-bottom: 16px; }
    .tab { padding: 8px 16px; border-radius: 8px; border: 1px solid transparent; background: transparent; color: var(--muted); font-size: 0.85rem; font-weight: 500; cursor: pointer; transition: all 0.15s; }
    .tab:hover { color: var(--text); border-color: var(--border); }
    .tab.active { background: #1c1c1e; border-color: var(--border); color: var(--text); font-weight: 600; }

    /* History bar */
    .history-bar { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 12px 16px; margin-bottom: 24px; display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    .history-label { font-size: 0.75rem; color: var(--muted); font-weight: 600; text-transform: uppercase; letter-spacing: 0.4px; flex-shrink: 0; }
    .hist-btn { padding: 5px 12px; border-radius: 6px; border: 1px solid var(--border); background: transparent; color: var(--muted); font-size: 0.78rem; cursor: pointer; }
    .hist-btn.active { border-color: #8b0a1a; color: #f87171; background: rgba(139,10,26,0.1); }
    .hist-btn:hover { color: var(--text); }

    /* Section */
    .section-title { font-size: 0.72rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; color: var(--muted); margin-bottom: 12px; }

    /* Cards */
    .card { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 10px; position: relative; }
    .card:hover { border-color: #3f3f46; }
    .card-title { font-size: 0.95rem; font-weight: 600; margin-bottom: 6px; }
    .card-row { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; align-items: center; }
    .badge { font-size: 0.72rem; font-weight: 600; padding: 3px 9px; border-radius: 20px; }
    .badge-green  { background: rgba(34,197,94,0.12);  color: var(--green); }
    .badge-yellow { background: rgba(234,179,8,0.12);  color: var(--yellow); }
    .badge-blue   { background: rgba(59,130,246,0.12); color: var(--blue); }
    .badge-purple { background: rgba(168,85,247,0.12); color: var(--purple); }
    .badge-red    { background: rgba(248,113,113,0.12);color: var(--red); }
    .badge-orange { background: rgba(245,158,11,0.12); color: var(--orange); }
    .badge-gray   { background: rgba(113,113,122,0.15);color: var(--muted); }
    .card-sub { font-size: 0.8rem; color: var(--muted); margin-top: 4px; line-height: 1.5; }
    .card-tip { font-size: 0.78rem; color: #a1a1aa; margin-top: 8px; padding: 8px 12px; background: var(--surface2); border-radius: 7px; border-left: 3px solid #8b0a1a; }
    .card-link { position: absolute; top: 14px; right: 14px; font-size: 0.75rem; color: var(--muted); text-decoration: none; }
    .card-link:hover { color: var(--text); }

    /* Stats row */
    .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-bottom: 24px; }
    .stat { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 14px 16px; }
    .stat-num { font-size: 1.6rem; font-weight: 700; }
    .stat-label { font-size: 0.75rem; color: var(--muted); margin-top: 2px; }

    .hidden { display: none; }
    a { color: inherit; }
  </style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <h1>âš¡ Daily Opportunity Hub</h1>
    <div class="header-meta">
      <span class="updated-badge" id="updated-badge">Loading...</span>
      <span class="version-badge" id="version-badge">vâ€”</span>
    </div>
  </div>

  <!-- History -->
  <div class="history-bar" id="history-bar">
    <span class="history-label">ðŸ“… History</span>
    <span id="history-btns"></span>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" onclick="showTab('jobs')">ðŸ’¼ Jobs</button>
    <button class="tab" onclick="showTab('ebay')">ðŸ“¦ eBay</button>
    <button class="tab" onclick="showTab('fiverr')">ðŸŽ¯ Fiverr</button>
    <button class="tab" onclick="showTab('upwork')">ðŸ’» Upwork</button>
    <button class="tab" onclick="showTab('youtube')">ðŸŽ¬ YouTube</button>
  </div>

  <!-- Stats -->
  <div class="stats" id="stats"></div>

  <!-- Sections -->
  <div id="tab-jobs"></div>
  <div id="tab-ebay" class="hidden"></div>
  <div id="tab-fiverr" class="hidden"></div>
  <div id="tab-upwork" class="hidden"></div>
  <div id="tab-youtube" class="hidden"></div>
</div>

<script>
let data = null;
let activeTab = 'jobs';

const HISTORY_FILES = [
  { label: 'Feb 24 (v1)', file: 'data/history/2026-02-24-v1.json' },
];

async function load(file = 'data/opportunities.json') {
  const r = await fetch(file + '?v=' + Date.now());
  data = await r.json();
  render();
}

function render() {
  // Header
  const d = new Date(data.last_updated);
  document.getElementById('updated-badge').textContent = 'Updated: ' + d.toLocaleDateString('en-GB', { day:'numeric', month:'short', year:'numeric', hour:'2-digit', minute:'2-digit' });
  document.getElementById('version-badge').textContent = 'v' + (data.version || '1');

  // History buttons
  document.getElementById('history-btns').innerHTML = [
    `<button class="hist-btn active" onclick="load('data/opportunities.json')">Latest</button>`,
    ...HISTORY_FILES.map(h => `<button class="hist-btn" onclick="load('${h.file}')">${h.label}</button>`)
  ].join('');

  // Stats
  document.getElementById('stats').innerHTML = `
    <div class="stat"><div class="stat-num">${data.jobs?.length||0}</div><div class="stat-label">Job leads</div></div>
    <div class="stat"><div class="stat-num">${data.ebay_products?.length||0}</div><div class="stat-label">eBay products</div></div>
    <div class="stat"><div class="stat-num">${data.fiverr_gigs?.length||0}</div><div class="stat-label">Fiverr gigs</div></div>
    <div class="stat"><div class="stat-num">${data.upwork_jobs?.length||0}</div><div class="stat-label">Upwork jobs</div></div>
    <div class="stat"><div class="stat-num">${data.youtube_ideas?.length||0}</div><div class="stat-label">YT ideas</div></div>
  `;

  renderJobs();
  renderEbay();
  renderFiverr();
  renderUpwork();
  renderYoutube();
}

function renderJobs() {
  const el = document.getElementById('tab-jobs');
  const jobs = data.jobs || [];
  const byType = { 'in-field': [], 'accessible': [], 'emerging': [], 'safety-net': [] };
  jobs.forEach(j => (byType[j.type] = byType[j.type] || []).push(j));

  const typeLabel = { 'in-field':'ðŸŽ¯ In Your Field', 'accessible':'ðŸ”“ Accessible Now', 'emerging':'ðŸš€ Emerging', 'safety-net':'ðŸ›¡ï¸ Safety Net' };
  const typeBadge = { 'in-field':'badge-green','accessible':'badge-blue','emerging':'badge-purple','safety-net':'badge-gray' };

  let html = '';
  Object.entries(byType).forEach(([type, list]) => {
    if (!list.length) return;
    html += `<div class="section-title">${typeLabel[type]||type}</div>`;
    list.forEach(j => {
      html += `<div class="card">
        ${j.url ? `<a href="${j.url}" target="_blank" class="card-link">â†— View</a>` : ''}
        <div class="card-title">${j.title}</div>
        <div class="card-sub">${j.platform} Â· ${j.location}</div>
        <div class="card-row">
          <span class="badge ${typeBadge[j.type]||'badge-gray'}">${j.type}</span>
          <span class="badge badge-yellow">Â£ ${j.estimated_salary}</span>
          ${j.match ? `<span class="badge badge-gray">Match: ${j.match}</span>` : ''}
        </div>
      </div>`;
    });
  });
  el.innerHTML = html || '<div style="color:#555;padding:20px">No jobs data</div>';
}

function renderEbay() {
  const el = document.getElementById('tab-ebay');
  const prods = data.ebay_products || [];
  let html = `<div class="section-title">Trending Products â€” eBay UK Â· Feb 2026</div>`;
  prods.forEach(p => {
    const effortBadge = { 'Very Low':'badge-green','Low':'badge-green','Medium':'badge-yellow','High':'badge-orange' }[p.effort]||'badge-gray';
    html += `<div class="card">
      <div class="card-title">${p.product}</div>
      <div class="card-sub">${p.category} Â· ${p.why}</div>
      <div class="card-row">
        <span class="badge badge-yellow">Avg Â£${p.avg_sell_price}</span>
        <span class="badge ${effortBadge}">Effort: ${p.effort}</span>
      </div>
      ${p.tip ? `<div class="card-tip">ðŸ’¡ ${p.tip}</div>` : ''}
    </div>`;
  });
  el.innerHTML = html;
}

function renderFiverr() {
  const el = document.getElementById('tab-fiverr');
  const gigs = data.fiverr_gigs || [];
  let html = `<div class="section-title">High-Demand Gigs You Can List Today</div>`;
  const demandBadge = { 'Very High':'badge-green','High':'badge-blue','Growing Fast':'badge-purple','Medium':'badge-yellow' };
  const compBadge = { 'Very Low':'badge-green','Low':'badge-green','Low-Medium':'badge-blue','Medium':'badge-yellow','High':'badge-red' };
  gigs.forEach(g => {
    html += `<div class="card">
      <div class="card-title">${g.title}</div>
      <div class="card-sub">${g.why}</div>
      <div class="card-row">
        <span class="badge ${demandBadge[g.demand]||'badge-gray'}">Demand: ${g.demand}</span>
        <span class="badge ${compBadge[g.competition]||'badge-gray'}">Competition: ${g.competition}</span>
        <span class="badge badge-yellow">${g.price_range}</span>
      </div>
      ${g.quick_start ? `<div class="card-tip">ðŸš€ Quick start: ${g.quick_start}</div>` : ''}
    </div>`;
  });
  el.innerHTML = html;
}

function renderUpwork() {
  const el = document.getElementById('tab-upwork');
  const jobs = data.upwork_jobs || [];
  let html = `<div class="section-title">Matching Upwork Opportunities</div>`;
  jobs.forEach(j => {
    html += `<div class="card">
      ${j.url ? `<a href="${j.url}" target="_blank" class="card-link">â†— Search</a>` : ''}
      <div class="card-title">${j.title}</div>
      <div class="card-row">
        <span class="badge badge-yellow">${j.budget}</span>
        <span class="badge badge-green">Match: ${j.match}</span>
        <span class="badge badge-gray">${j.frequency}</span>
      </div>
      ${j.tip ? `<div class="card-tip">ðŸ’¡ ${j.tip}</div>` : ''}
    </div>`;
  });
  el.innerHTML = html || '<div style="color:#555;padding:20px">No data</div>';
}

function renderYoutube() {
  const el = document.getElementById('tab-youtube');
  const ideas = data.youtube_ideas || [];
  let html = `<div class="section-title">Video Ideas for @prompttocide</div>`;
  const potBadge = { 'Very High':'badge-green','High':'badge-blue','Medium':'badge-yellow' };
  ideas.forEach(i => {
    html += `<div class="card">
      <div class="card-title">${i.title}</div>
      <div class="card-sub">${i.format}</div>
      <div class="card-row">
        <span class="badge ${potBadge[i.potential?.split(' ')[0]]||'badge-gray'}">Potential: ${i.potential?.split('â€”')[0]||i.potential}</span>
        <span class="badge badge-gray">Effort: ${i.effort}</span>
      </div>
      ${i.tip ? `<div class="card-tip">ðŸ’¡ ${i.tip}</div>` : ''}
    </div>`;
  });
  el.innerHTML = html;
}

function showTab(tab) {
  activeTab = tab;
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  ['jobs','ebay','fiverr','upwork','youtube'].forEach(t => {
    document.getElementById('tab-' + t).classList.toggle('hidden', t !== tab);
  });
}

load();
</script>
</body>
</html>
